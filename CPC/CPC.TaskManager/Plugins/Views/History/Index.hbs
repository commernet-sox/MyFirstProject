{{!<Layout}}
{{ViewBag Title='执行历史'}}

{{#if ViewBag.HistoryEnabled}}

{{#if Model}}
<div class="ui message">
    <i class="info circle icon"></i>
    History is periodicaly purged. Only recent job executions are shown.
</div>
{{/if}}

<table class="ui single line table highlight-rows" id="history-list">
    <thead>
        <tr>
            <th>任务</th>
            <th>触发器</th>
            <th>计划时间</th>
            <th>实际时间</th>
            <th>完成时间</th>
            <th>运行时间</th>
        </tr>
    </thead>
    <tbody>
        {{#each Model}}
        <tr>
            <td class="job-key">
                <i class="{{StateIcon}} icon" title="{{State}}"></i>
                <a href="{{ActionUrl 'Edit' 'Jobs' group=JobGroup name=JobName}}">{{JobGroup}}.{{JobName}}</a>
            </td>
            <td><a href="{{ActionUrl 'Edit' 'Triggers' group=TriggerGroup name=TriggerName}}">{{TriggerGroup}}.{{TriggerName}}</a></td>
            <td>{{ScheduledFireTimeUtc}}</td>
            <td>{{ActualFireTimeUtc}}</td>
            <td>{{FinishedTimeUtc}}</td>
            <td>{{Duration}}</td>
        </tr>
        {{#if Entity.ExceptionMessage}}
        <tr class="error-row">
            <td colspan="6">
                <p>{{Entity.ExceptionMessage}}</p>
            </td>
        </tr>
        {{/if}}
        {{/each}}
    </tbody>
</table>

{{#unless Model}}
{{>EmptyList ''}}
{{/unless}}
{{else}}
<div class="ui negative message">
    <div class="header" style="margin-bottom: 0.5em">作业历史记录没有启用</div>
    在Quartz配置中启用 ExecutionHistoryPlugin
</div>
{{/if}}